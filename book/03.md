# IP 地址规划技术

## 前言

选择题 8 ~ 11， 综合题第一题、应用题子网划分（占分值 20 分）。

## 内容

### 一、IP地址分类及子网划分

#### 标准分类的 IP 地址

常用的 A 类、B 类、C 类采用包括“网络-主机号”的两级的层级结构。

IPv4 的 **地址长度是 32bit**，用 **点分十进制** 表示，如 x.x.x.x 的格式。其中每个 **x 为 8bit**，取值范围（00000000-11111111）,对应的十进制取值范围是（0-255）。

机器中存放的 IP 地址是 32 位二进制代码，每隔 8 为插入一个空格能提高可读性，将每 8 为的二进制数转换为十进制数，采用点分十进制记法则更加便于使用。

        10000000 00001011 00000011 0001111 => 128.11.3.31

![地址类别](/../static/images/03-01.png)

每个网络中“全 0”和“全 1”的主机号的地址有特殊用法，所以是需要去除的

| 地址类别 |        主机地址范围         |     可分配的网络数     | 每个网络内可分配的最大主机数 |
| :------: | :-------------------------: | :--------------------: | :--------------------------: |
|   A 类   |  1.0.0.0 ~ 127.255.255.255  |   2<sup>7</sup>=128    |  2<sup>24</sup>-2=16777214   |
|   B 类   | 128.0.0.0 ~ 191.255.255.255 |   2<sup>14</sup>=128   |    2<sup>16</sup>-2=65534    |
|   C 类   | 192.0.0.0 ~ 223.255.255.255 | 2<sup>21</sup>=2097152 |     2<sup>8</sup>-2=254      |

#### 特殊地址形式

特殊的 IP 地址包括：**受限广播地址、直接广播地址、“这个网络上的特定主机”地址**与回送地址。

1. 受限广播地址

   受限官博地址又称有限广播地址，该地址形式唯一，即：**32 位全为 1 的 IP 地址（255.255.255.255）**。此地址用来将一个分组以广播方式发送给本网络中的所有主机（本网内成员向全网广播）。

2. 直接广播地址

    **直接广播地址的形式是一个有效的网络号和一个全 1 的主机号**，用来使路由器将一个来自其他网络的分组以广播方式发送给特定网络上的所有主机。

    **在 IP 地址计算中：直接广播地址使 IP 地址网络号不变，主机号全为 1 的地址**。

3. “这个网络上的特定主机”地址——主机号

    “这个网络上的特定主机”地址用于同一网络内部某个主机或某个路由器向另一个主机发送分组。

    **“这个网络上的特定主机”地址的形式为一个全 0 的网络号和一个确定的主机号**。

    **在 IP 地址计算中：主机号是 IP 地址网络全为 0 主机号不变的地址**。

    
4. 回送地址

    A 类 IP 地址中的 127.0.0.0 是一个保留地址，它即回送地址。用于网络软件测试和本地进程间通信使用。

#### 子网掩码

1. 地址结构

    标准的 A 类、B 类与 C 类 IP **地址都是网络号与主机号两级层次结构**。**IP 地址:: = {<网络号>，<主机号>}**

    子网采用网络号-子网号-主机号的三层 IP 地址结构。**IP 地址:: = {<网络号>，<子网号>，<主机号>}**

    从主机号借用若干个位作为子网号 subnet-id，而主机号 host-id 也就相应减少了若干个位。

2. 概念

    - 子网掩码主要是用来区分 IP 地址中的网络号（网络号+子网号）和主机号。
    - 子网掩码的结构与形式跟 IP 地址一样，也由 32 位的二进制组成，用点分十进制法表示。
    - 子网掩码与 IP 地址的对应关系是，IP 地址中网络号所在的位对应的子网掩码中的相应为 1，IP 地址中主机号所在的位对应的子网掩码中的相应位为 0。
    - **注意：IP 地址中网络号和主机号是由子网掩码来确定的，子网掩码二进制表示中全为 1 则对应 IP 地址位段的是网络号，全为 0 则对应 IP 地址位段的是主机号**。
  
![网络地址子网掩码组成图](/../static/images/03-01.png '网络地址子网掩码组成图')

    子网内第一个可用的 IP 地址：子网号（网络地址）后的第一个地址。
    子网内最后一个可用的 IP 地址：直接广播地址前一个地址。

3. 子网划分

  （1）判断客户需求的网络数与主机数。（2）配置满足需求的基本网络地址结构。（3）配置地址掩码。（4）配置网络地址。（5）配置网络广播地址。（6）配置网络的主机地址。
  
   1. 规划子网地址的基本步骤

    - 确定要划分的**子网数**
    - 求出子网数目对应二进制的位数 N 以及主机数目对应二进制的位数 M。
    - 在该 IP 地址的原子网掩码的基础上，将其主机地址部分的前 N 位置取 1 和后 M 位置取0，即得出该 IP 地址划分子网后的子网掩码。

   2. 规划子网地址的基本思想

    - 熟记 2 的幂：1，2，3，8，16，64，128，256。
    - 用过划分子网可以将一个网络划分若干个小网络以满足不同部门的需要，而从外部来看仍然像一个网络一样。划分子网即优化网络性能又提高了网络管理的效率。

   3. 划分子网的基本方法

    - 你选择的子网掩码将会产生多少个子网？2<sup>N</sup>-2（N 代表网络位借用主机的位数）。
    - 每个子网能有多少主机？2<sup>M</sup>-2（M 代表主机位）。
    - 每个子网的网络地址：主机位全为 0。
    - 每个子网的广播地址：主机位全为 1。

### 二、无类域间路由技术（CIDR）

### 三、NAT工作原理

### 四、IPv6地址的特点

## 总结